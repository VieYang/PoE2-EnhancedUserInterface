# PoE2 - Enhanced User Interface:

## Tutorial:

## 1. Used entries:

### 1.1 Used entries in abilities.stringtable:
```
237|238|239|240|244|245|246|252|253|254|255|256|257|258|259|260|263|265|269|270|272|275|276|277|279|282|283|284|286|288|290|292|300|301|303|305|311|314|315|320|325|352|356|358|395|397|400|405|407|409|411|413|415|417|421|423|427|430|433|435|439|441|444|450|455|458|476|481|483|485|496|498|500|506|511|513|515|517|519|521|525|528|532|534|536|539|543|550|552|554|560|564|566|571|573|577|579|581|585|587|589|595|597|599|601|603|605|607|614|639|641|643|646|791|792|793|794|800|801|803|804|806|807|808|809|810|811|812|813|817|818|819|820|821|822|824|826|827|829|830|831|832|835|836|838|839|844|847|851|853|855|857|859|860|861|863|865|866|871|884|885|886|892|895|897|902|905|913|916|922|924|926|927|928|954|1015|1016|1026|1035|1036|1037|1041|1048|1050|1052|1058|1074|1082|1212|1259|1270|1281|1306|1307|1324|1326|1328|1330|1334|1338|1341|1342|1391|1465|1466|1468|1470|1472|1475|1476|1477|1478|1480|1569|1570|1571|1572|1573|1577|1578|1595|1721|1723|1730|1733|1737|1739|1740|1743|1745|1748|1749|1750|1751|1753|1754|1757|1760|1764|1765|1766|1769|1771|1806|1883|1928|1930|1938|1942|1951|1962|1964|1967|1968|1981|1983|1994|2000|2004|2014|2018|2022|2029|2032|2038|2041|2044|2045|2047|2055|2057|2061|2063|2076|2083|2090|2109|2112|2124|2129|2134|2137|2139|2141|2155|2156|2157|2159|2160|2192|2225|2247|2261|2271|2273|2297|2299|2317|2335|2337|2385|2386|2387|2389|2401|2409|2411|2421|2423|2459|2465|2467|2469|2476|2478|2480|2484|2486|2494|2496|2503|2507|2509|2511|2540|2542|2543|2546|2549|2564|2571|2572|2574|2582|2584|2588|2590|2596|2602|2609|2613|2635|2639|2648|2651|2654|2658|2661|2667|2672|2674|2682|2687|2691|2693|2695|2699|2701|2702|2707|2708|2709|2721|2723|2752|2758|2760|2781|2783|2791|2798|2813|2817|2821|2827|2831|2843|2845|2847|2849|2854|2860|2870|2873|2879|2889|2896|2898|2900|2902|2966|2968|2978|2980|2982|2984|3098|3186|3192|3207|3252|3292|3294|3307|3309|3313|3319|3337|3345|3349|3368|3395|3401|3429|3435|3448|3449|3451|3506|3512|3521|3523|3547|3549|3596|3608|3612|3677|3689|3695|3697|3702|3749|3758|3762|3764|3769|3810|3812|3814|3820|3825|3833|3835|3856|3858|3864|3866|3877|3883|3885|3899|3903|3911|3915|3939|3953|3960|3962|3965|3971|3993|4100|4102|4113|4132|4134|4140|4145|4155|4159|4160|4276|4292|4294|4296|4298|4300|4302|4304|4306|4308|4313|4315|4317|4321|4324|4333|4335|4336|4338|4353|4361|4362|4377|4382|4384|4387|4394|4412|4483|4507|4512|4558|4559|4560|4562|4578|4588|4593|4611|4634|4638|4640|4641|4642|4643|4659|4669|4672|4673|4685
```

### 1.2 Used entries in cyclopedia.stringtable:
```
84|86|88|90|92|94|96|98|100|102|104|106|108|110|112|116|118|120|122|124|130|134|140|146|148|150|154|158|180|192|194|203|207|322|324|453|463|475|533|590|679|681|683|687|689|695|696|697|698|699|701|703|705|707|709|711|713|715|717|719|721|723|725|727|729|731|733|735|737|739|741|743|745|747|753|755|
```

### 1.3 Used entries in gui.stringtable:
```
391|392|4756|4757|88002|88003|88004|88005|88006|88007|88008|88009|88010|88011|88012
```

### 1.4 Used entries in items.stringtable:
```
1798|2361|2852|2866|3114|3116|3122|3138|3143|3145|3154|3156|3180|3394|3395|3398|3399|3401|3402|3403|3404|3407|3409|3410|3411|3412|3414|3415|3418|3419|3422|3424|3428|3429|3432|3435|3436|3437|3439|3639|3640|3641|3648|3650|3653|3655|3659|3691|3693|3695|3830|4282|4390|4410|4429|4456|4485|4645|4647|4922|5137|5145|5149
```

### 1.5 Used entries in statuseffects.stringtable:
```
0|2|3|4|5|7|8|9|10|11|13|22|26|32|33|34|35|36|38|39|42|43|46|48|53|58|60|63|64|65|70|73|74|76|77|81|83|86|90|92|101|106|109|110|111|112|117|120|124|125|134|136|138|141|149|150|152|154|157|158|159|161|162|164|165|171|172|178|181|183|184|185|186|187|188|194|195|196|201|202|209|211|212|213|214|216|220|224|225|226|230|240|241|242|245|246|252|253|256|257|258|259|261|270|271|272|274|284|297|285|298|287|299|290|294|301|302|303|305|306|312|314|323|325|332|338|340|347|348|351|352|375|379|380|384|391|392|393|399|400|401|405|406|411|413|416|419|420|424|426|435|436|446|451|453|455|456|458|459|463|470|478|485|486|487|488|489|498|504|505|506|507|508|512|520|523|535|536|544|549|551|552|570|571|576|1798|2361|2852|2866|3114|3116|3122|3138|3143|3154|3156|3180|3395|3401|3402|3404|3407|3410|3411|3412|3415|3418|3424|3428|3429|3432|3436|3437|3439|3639|3640|3641|3650|3653|3655|3659|3691|3695|4282|4390|4410|4429|4456|4645|4647|4922|5145|5149
```

## 2. Adding standard line-height to all entries
Use find/replace to find:
```
<DefaultText>([\s\S]*?)<\/DefaultText>
```
And replace with:
```
<DefaultText>&lt;line-height=100%&gt;$1&lt;/line-height&gt;</DefaultText>
```

## 3. Find all Attribute inspirations/afflictions:
```
(Dexterity|Constitution|Might|Intellect|Resolve|Perception) ((Affliction(\b|s))|(Inspiration(\b|s)))
```
Attributes - what's needed:
```
&lt;link="glossary://GlossaryEntry_[Affliction or Inspiration?]_[What attribute?]"&gt;&lt;#[What color?]&gt;[What attribute?]&#160;[Affliction or Inspiration?]&#160;&lt;sprite="Inline" name="attribute_[What attribute (lowercase)]" tint=1&gt;&lt;/color&gt;&lt;/link&gt;
```

Afflictions/inspirations - what's needed:
```
&lt;link="glossary://GlossaryEntry_[Name of the affliction or inspiration?]"&gt;&lt;#[What color?]&gt;[Name of the affliction or inspiration?]&lt;space=0.7em&gt;&lt;sprite="Inline" name="attribute_[attribute name (lowercase)]" tint=1&gt;&lt;space=0.3em&gt;&lt;voffset=[affliction (-) or inspiration (+)?]0.35em&gt;&lt;size=80%&gt;&lt;b&gt;[what rank?]&lt;/b&gt;&lt;/size&gt;&lt;/voffset&gt;&lt;/color&gt;&lt;/link&gt;
```

### 3.1 Constitution:
Find:
```
(Constitution) (Affliction(\b|s)|Inspiration(\b|s))

&lt;link="glossary://GlossaryEntry_$2_$1"&gt;&lt;#f7b733&gt;$1&#160;$2&#160;&lt;sprite="Inline" name="attribute_$1" tint=1&gt;&lt;/color&gt;&lt;/link&gt;
```


```
(Fit|Hardy|Robust)(\sInspiration(\b|s)|[\S\s])

&lt;link="glossary://GlossaryEntry_$1"&gt;&lt;#f7b733&gt;$1&lt;space=0.7em&gt;&lt;sprite="Inline" name="attribute_constitution" tint=1&gt;&lt;space=0.3em&gt;&lt;voffset=0.35em&gt;&lt;size=80%&gt;&lt;b&gt;2&lt;/b&gt;&lt;/size&gt;&lt;/voffset&gt;&lt;/color&gt;&lt;/link&gt; Inspiration

(Sicken(\b|ed|ing)|Weaken(\b|s|ed|ing)|Enfeebled)(\sAffliction(\b|s)|[\S\s])
```

### 3.2 Resolve
```
(Resolve) (Affliction(\b|s)|Inspiration(\b|s))

&lt;link="glossary://GlossaryEntry_$2_$1"&gt;&lt;#30d3d5&gt;$1&#160;$2&#160;&lt;sprite="Inline" name="attribute_$1" tint=1&gt;&lt;/color&gt;&lt;/link&gt;

(Steadfast|Resolute|Courageous|Shaken(\b|s|ed|ing)|Frighten(\b|s|ed|ing)|Terrif(ies|ied|ying|y))(\sAffliction(\b|s)|\sInspiration(\b|s)|[\S\s])
```

### 3.3 Dexterity
```
(Dexterity) (Affliction(\b|s)|Inspiration(\b|s))

&lt;link="glossary://GlossaryEntry_$2_$1"&gt;&lt;#72da26&gt;$1&#160;$2&#160;&lt;sprite="Inline" name="attribute_$1" tint=1&gt;&lt;/color&gt;&lt;/link&gt;

(Quick|Nimble|Swift|Hobbl(ed|es|e|ing)|Immobiliz(ed|e|ing)|Paralyz(ed|es|e|ing|ation))(\sAffliction(\b|s)|\sInspiration(\b|s)|[\S\s])
```

### 3.4 Might
```
(Might) (Affliction(\b|s)|Inspiration(\b|s))

&lt;link="glossary://GlossaryEntry_$2_$1"&gt;&lt;#f7b733&gt;$1&#160;$2&#160;&lt;sprite="Inline" name="attribute_$1" tint=1&gt;&lt;/color&gt;&lt;/link&gt;

(Strong|Tenacious|Energized|Stagger(\b|ed|ing)|Daz(ed|es|e|ing)|Stun(\b|s|ned|ning))(\sAffliction(\b|s)|\sInspiration(\b|s)|[\S\s])
```

### 3.5 Intellect
```
(Intellect) (Affliction(\b|s)|Inspiration(\b|s))

&lt;link="glossary://GlossaryEntry_$2_$1"&gt;&lt;#00a4ff&gt;$1&#160;$2&#160;&lt;sprite="Inline" name="attribute_$1" tint=1&gt;&lt;/color&gt;&lt;/link&gt;

(Smart|Acute|Brilliant|Confus(ed|es|e|ing)|Charm(\b|ed|ing)|Dominat(ed|es|e|ing))(\sAffliction(\b|s)|\sInspiration(\b|s)|[\S\s])
```

### 3.6 Perception
```
(Perception) (Affliction(\b|s)|Inspiration(\b|s))

&lt;link="glossary://GlossaryEntry_$2_$1"&gt;&lt;#ca58ff&gt;$1&#160;$2&#160;&lt;sprite="Inline" name="attribute_$1" tint=1&gt;&lt;/color&gt;&lt;/link&gt;

(Insightful|Aware|Intuitive|Distract(\b|ed|s|ing)|Disorient(\b|ed|s|ing)|Blind(\b|s|ed|ing|ness))(\sAffliction(\b|s)|\sInspiration(\b|s)|[\S\s])
```

### 3.7 Defenses
```
(Deflection|Reflex|Reflexes|Fortitude|Willpower|Will|Penetrate|AR|Armor Rating)
```

### 3.8 Damage types
```
(Shock(\b|ed|s|ing)|Burn(\b|ed|ing|s)|Freez(es|ed|e|ing)|Corro(des|de|sive)|Slash(\b|ing)|Pierce(\b|es|ing)|Crush(\b|es|ing)|Raw)
```

### 3.9 Mind and Body
```
(Mind|Body) Affliction(\b|s)|(Mind|Body) Inspiration(\b|s)
```


// Replace with:
```XML
&lt;link="glossary://GlossaryEntry_$2_$1"&gt;&lt;#[COLOR CODE]&gt;$1&#160;$2&#160;&lt;sprite="Inline" name="attribute_$1" tint=1&gt;&lt;/color&gt;&lt;/link&gt;
```
Then you need to replace the #[COLOR CODE] color tag and the name="attribute_[attribute]" tag with:

Color tag (find):
```
glossary://GlossaryEntry_(Afflictions|Inspirations)_Dexterity|Constitution|Might|Intellect|Resolve|Perception)"&gt;&lt;#\[COLOR CODE\]
```

Color tag (replace):

```
#(72da26|f7b733|ff4800|00a4ff|30d3d5|ca58ff)
```

Attribute (find):
```
attribute_(Dexterity|Constitution|Might|Intellect|Resolve|Perception)
```
Attribute (replace):
```
attribute_(dexterity|constitution|might|intellect|resolve|perception)
```

End result should be (for Perception Affliction):
```
&lt;link="glossary://GlossaryEntry_Afflictions_Perception"&gt;&lt;#ca58ff&gt;Perception&#160;$2&#160;&lt;sprite="Inline" name="attribute_perception" tint=1&gt;&lt;/color&gt;&lt;/link&gt;
```

##### Ad hoc rules:

This is for Cyclopedia entries that begin with `<DefaultText>[Attribute] [Affliction/Inspiration].`

Find:
```
&lt;link="glossary://GlossaryEntry_(Afflictions|Inspirations)_(Dexterity|Constitution|Might|Intellect|Resolve|Perception)"&gt;&lt;#(72da26|f7b733|ff4800|00a4ff|30d3d5|ca58ff)&gt;(Dexterity|Constitution|Might|Intellect|Resolve|Perception)&#160;$2&#160;&lt;sprite="Inline" name="attribute_(dexterity|constitution|might|intellect|resolve|perception)" tint=1&gt;&lt;/color&gt;&lt;/link&gt;
```
Replace:
```
&lt;voffset=0.5em&gt;&lt;size=95%&gt;&lt;link="glossary://GlossaryEntry_$1_$2"&gt;&lt;#dac79c&gt;$2&#160;$1&lt;/color&gt;&lt;/link&gt;&lt;/size&gt;&lt;/voffset&gt;


```
It's important to get the extra line break in so that the attribute name is placed on it's own text-line.

#### Keep an eye on the following Entry ID's cause they might need manual touch-ups:
```
564|603|1962|1964|1967|1968|2896|2898|2900|2902
```
```
2032|2423|2654|3856
```

#### Glossary entries for all afflictions:
```
GlossaryEntry_(Blinded|Charmed|Confused|Dazed|Disoriented|Distracted|Dominated|Enfeebled|Frightened|Hobbled|Immobilized|Paralyzed|Shaken|Sickened|Staggered|Stunned|Terrified|Weakened)
```


Color for H2 = dac79c
```
\s+<Entry>\s+<ID>.*?<\/ID>([\S\s](?!dac79c))*?<\/Entry>
```

## Remove all unused entries

RegEx 1 (use this one):
```
\s+<Entry>\s+<ID>.*?<\/ID>([\S\s](?!Constitution|Fit|Hardy|Robust|Sicken(\b|ed|ing)|Weaken(\b|s|ed|ing)|Enfeebled|Resolve|Steadfast|Resolute|Courageous|Shaken(\b|s|ed|ing)|Frighten(\b|s|ed|ing)|Terrif(ies|ied|ying|y)|Dexterity|Quick|Nimble|Swift|Hobbl(ed|es|e|ing)|Immobiliz(ed|e|ing)|Paralyz(ed|es|e|ing|ation)|Might|Strong|Tenacious|Energized|Stagger(\b|ed|ing)|Daz(ed|es|e|ing)|Stun(\b|s|ned|ning)|Intellect|Smart|Acute|Brilliant|Confus(ed|es|e|ing)|Charm(\b|ed|ing)|Dominat(ed|es|e|ing)|Perception|Insightful|Aware|Intuitive|Distract(\b|ed|s|ing)|Disorient(\b|ed|s|ing)|Blind(\b|s|ed|ing|ness)|Deflection|Reflex|Reflexes|Fortitude|Willpower|Will|Penetrate|AR|Shock(\b|ed|s|ing)|Burn(\b|ed|ing|s)|Freez(es|ed|e|ing)|Corro(des|de|sive)|Slash(\b|ing)|Pierc(\b|es|e|ing)|Crush(\b|es|ing)|Raw|(Mind|Body) Affliction(\b|s)|(Mind|Body) Inspiration(\b|s)))*?<\/Entry>
```
